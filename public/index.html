<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Генератор Цитат</title>
    <style>
        body { 
            font-family: sans-serif; 
            max-width: 600px; 
            margin: 0 auto; 
            padding: 20px; 
            text-align: center; 
        }
        .box { 
            border: 1px solid #ccc;
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            background-color: #f9f9f9; 
        }
        input { 
            padding: 10px; 
            width: 80%; 
            margin-bottom: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
        button { 
            padding: 10px 20px; 
            cursor: pointer; 
            background-color: #28a745; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            font-size: 16px; 
        }
        button.get-btn { 
            background-color: #007bff; 
        }
        button:hover { 
            opacity: 0.9;
        }
    </style>
</head>
<body>

    <h1>Генератор Цитат</h1>
    <button class="get-btn" onclick="getQuote()">Получить случайную цитату</button>
    
    <div class="box" id="quote-box">
        <p>Нажми кнопку выше, чтобы увидеть мудрость...</p>
    </div>

    <hr>

    <h2>Добавить свою цитату</h2>
    <div class="box">
        <input type="text" id="newText" placeholder="Текст цитаты" required>
        <br>
        <input type="text" id="newAuthor" placeholder="Автор" required>
        <br>
        <button onclick="addQuote()">Сохранить в базу</button>
        <p id="status-msg" style="color: green; margin-top: 10px;"></p>
    </div>

    <script>
        async function getQuote() {
            const response = await fetch('/api/quotes/random');
            const data = await response.json();
            
            document.getElementById('quote-box').innerHTML = 
                `<h3>"${data.text}"</h3><p>${data.author}</p>`;
        }

        async function addQuote() {
            const textInput = document.getElementById('newText');
            const authorInput = document.getElementById('newAuthor');
            const statusMsg = document.getElementById('status-msg');

            const newQuote = {
                text: textInput.value,
                author: authorInput.value
            };

            if (!newQuote.text || !newQuote.author) {
                alert("заполните оба поля");
                return;
            }

            try {
                const response = await fetch('/api/quotes', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(newQuote)
                });

                if (response.ok) {
                    const result = await response.json();
                    statusMsg.innerText = `Цитата добавлена. ID: ${result.id}`;

                    textInput.value = '';
                    authorInput.value = '';
                } else {
                    statusMsg.style.color = 'red';
                    statusMsg.innerText = 'Ошибка при добавлении';
                }

            } catch (error) {
                console.error('Ошибка:', error);
            }
        }
    </script>
</body>
</html>